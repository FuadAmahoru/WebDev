using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.IO;
using Newtonsoft.Json;
namespace WebA1
{
    class MainMenu : Menu
    {
       public MainMenu()
        {
            
            displayTitle("Main Menu");
            menuItem.Add("Owner");
            menuItem.Add("Franchise Owner");
            menuItem.Add("Customer");
            menuItem.Add("Quit");
            displayList();
            displayHint();
               
            
        }
  
       bool validingInput()
        {
            int option;
            
           
                option = getInput(Console.ReadLine());
                if (option!=-1)
                {
                    
                    switch (option)
                 {
                    case 1:
                        Owner owner = new Owner();
                        owner.runOwnerMenu();
                        break;

                    case 2:
                        requestStore();
                        break;

                    case 3:
                        
                        Customer cust = new Customer();
                        cust.runCustomerMenu();
                        break;

                    case 4:
                        quit();
                        break;

                    default:
                        Console.WriteLine("The option is not available! Please enter another option(1 to {0}):",menuItem.Count);
                        Console.WriteLine();
                        Console.WriteLine();
                        Console.WriteLine();
                        return false;
                       
                }
                return true;
                }else
                {
                    Console.WriteLine("Please enter correct value!");
                return false;
                }
                

            
        }
        
       public void runMainMenu()
        {
            bool input;
            while (true) { 
                
                input = validingInput();
                if (!input)
                {
                    new MainMenu();
                }
            } 
        }
        
       public void quit()
        {
            Environment.Exit(0);
        }

        void requestStore()
        {
           // Store store;
           // bool invalid = false;
            while (true)
            {
                Console.Clear();
                Console.WriteLine("Choose a store Id: \n ");
                 
                    var stores = JsonUtility.readJsonFile<List<Store>>("F:\\stores.json"
                        );
                for(int i =0; i<stores.Count; i++)
                {
                    Console.WriteLine("    {0} . {1} ",  i+1 ,stores[i].Name);
                }
                Console.WriteLine();
                Console.WriteLine("Please enter an option : ");
                    int option = getInput(Console.ReadLine());
                    if (option == -1)
                    {
                        Console.WriteLine("The Store ID is invalid, Please enter again");
                        continue;
                    }
                    else
                    {
                        switch (option)
                        {
                            case 1:
                                Franchise store1 = new Franchise(stores[option - 1].Name);
                                store1.runFranchiseMenu();
                                break;
                            case 2:
                                Franchise store2 = new Franchise(stores[option - 1].Name);
                                store2.runFranchiseMenu();
                                break;
                            case 3:
                                Franchise store3 = new Franchise(stores[option - 1].Name);
                                store3.runFranchiseMenu();
                                break;
                            case 4:
                                Franchise store4 = new Franchise(stores[option - 1].Name);
                                store4.runFranchiseMenu();
                                break;
                            case 5:
                                Franchise store5 = new Franchise(stores[option - 1].Name);
                                store5.runFranchiseMenu();
                                break;
                            default :
                                Console.WriteLine("The Store ID is between 1 and {0},Please enter ID again", stores.Count);
                                break;

                        }
                    }
                
            }

           // return
        }
    }
}
